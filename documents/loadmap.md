# AETL v2 â€” Execution-Oriented Architecture Revision

> **í•µì‹¬ ì² í•™ ë³€ê²½**: "SQLì„ ìƒì„±í•œë‹¤" â†’ **"SQLì„ ìƒì„±í•˜ê³ , ì‹¤í–‰í•˜ê³ , ê²°ê³¼ë¬¼ì„ ë§Œë“¤ì–´ë‚¸ë‹¤"**
> **Version**: 2.1
> **Date**: 2026-02-26
> **ì£¼ìš” ì„¤ê³„ ì›ì¹™ (v2.1 ì¶”ê°€)**:
> 1. Auto-FixëŠ” AI ì œì•ˆ â†’ **Human ìŠ¹ì¸ â†’ 1íšŒ ì‹¤í–‰** (ìë™ ë£¨í”„ ê¸ˆì§€)
> 2. DW ì„¤ê³„ ì…ë ¥ì€ Swagger/Excel ìš°ì„ , AIëŠ” **ì´ˆì•ˆ(Draft)** ì œê³µ
> 3. Lineage íŒŒì‹±ì€ **sqlglot(ê·œì¹™ ê¸°ë°˜)**, LLMì€ ê²°ê³¼ ì„¤ëª…ë§Œ ë‹´ë‹¹

---

## 1. íŒ¨ëŸ¬ë‹¤ì„ ì „í™˜: Generate â†’ Execute â†’ Deliver

### 1.1 v1 vs v2 ë¹„êµ

```
v1 (ê¸°ì¡´ ì„¤ê³„) â€” "ë³´ì¡° ë„êµ¬" ìˆ˜ì¤€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë©”íƒ€ë°ì´í„°â”‚ â†’  â”‚ SQL ìƒì„±  â”‚ â†’ â”‚  í™”ë©´ì—   â”‚  â† ì—¬ê¸°ì„œ ë
â”‚   ë¶„ì„    â”‚    â”‚          â”‚   â”‚  ë³´ì—¬ì¤Œ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

v2 (ê°œì„  ì„¤ê³„) â€” "ì‹¤í–‰ í”Œë«í¼" ìˆ˜ì¤€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë©”íƒ€ë°ì´í„° â”‚ â†’  â”‚ SQL ìƒì„±  â”‚ â†’ â”‚ ì§ì ‘ ì‹¤í–‰ â”‚ â†’ â”‚ ê²°ê³¼ ë¶„ì„ â”‚ â†’ â”‚ ì‚°ì¶œë¬¼   â”‚
â”‚   ë¶„ì„    â”‚    â”‚ + ê²€ì¦SQL â”‚   â”‚(SELECTë§Œ) â”‚   â”‚ + AIì§„ë‹¨  â”‚   â”‚ ìë™ìƒì„±  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â†‘                â†“          â”œâ”€ ë§¤í•‘ì •ì˜ì„œ Excel
                                 [ì‚¬ëŒì´ ìŠ¹ì¸]    [ìˆ˜ì • SQL ì œì•ˆ]  â”œâ”€ ê²€ì¦ ë¦¬í¬íŠ¸
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”œâ”€ DDL Script
                                      Human-in-the-Loop           â””â”€ ì„¤ê³„ ì‹œê°í™”(Mermaid)
```

### 1.2 ì‚¬ëŒì˜ ì‘ì—…ì„ ì¤„ì´ëŠ” ê´€ì ì—ì„œì˜ ìë™í™” ë²”ìœ„

| ê¸°ì¡´(ì‚¬ëŒì´ í•˜ëŠ” ì‘ì—…) | AETL v2(ìë™í™”) | ì ˆê° íš¨ê³¼ |
|----------------------|----------------|----------|
| ì†ŒìŠ¤ í…Œì´ë¸” ë¶„ì„ â†’ ì—‘ì…€ì— ì •ë¦¬ | ë©”íƒ€ë°ì´í„° ìë™ í¬ë¡¤ë§ + í”„ë¡œíŒŒì¼ë§ | ~90% |
| ë§¤í•‘ì •ì˜ì„œ ìˆ˜ì‘ì—… ì‘ì„± | ë§¤í•‘ ë¡œì§ ìƒì„± â†’ **ì—‘ì…€ í…œí”Œë¦¿ ìë™ ê¸°ì…** | ~85% |
| ì ì¬ SQL ìˆ˜ì‘ì—… ì‘ì„± | NL/ê·œì¹™ ê¸°ë°˜ SQL ìƒì„± | ~70% |
| ê²€ì¦ SQL ìˆ˜ì‘ì—… ì‘ì„± + ì‹¤í–‰ | ê²€ì¦ ê·œì¹™ ìë™ ì œì•ˆ â†’ **ì¦‰ì‹œ ì‹¤í–‰(SELECT)** | ~80% |
| ê²€ì¦ ì˜¤ë¥˜ ìˆ˜ë™ ë¶„ì„ + SQL ìˆ˜ì • | AI ì˜¤ë¥˜ ë¶„ì„ â†’ **ìˆ˜ì • SQL ì œì•ˆ â†’ ì‚¬ëŒ ìŠ¹ì¸ í›„ ì‹¤í–‰** | ~60% |
| DW ëª¨ë¸ ì„¤ê³„ (ERD ê·¸ë¦¬ê¸°) | Swagger/Excel â†’ **AI ì´ˆì•ˆ â†’ ì‚¬ìš©ì í¸ì§‘ í™•ì •** | ~50% |
| ì„¤ê³„ ë¬¸ì„œì—ì„œ DDL ìˆ˜ì‘ì—… ì¶”ì¶œ | ì„¤ê³„ í™•ì • â†’ **DDL ì›í´ë¦­ ìƒì„±** | ~95% |

---

## 2. ì‹ ê·œ í•µì‹¬ ê¸°ëŠ¥ â€” ìƒì„¸ ì„¤ê³„

### 2.1 Feature #1: ë§¤í•‘ì •ì˜ì„œ ìë™í™” ì—”ì§„

#### 2.1.1 ì „ì²´ íë¦„

```
[ì‚¬ìš©ì ì…ë ¥]
"ODS_ê³ ê° â†’ DW_ê³ ê°_FACT ë§¤í•‘ ìƒì„±í•´ì¤˜"
     â”‚
     â–¼
[Step 1] ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘
â”œâ”€â”€ ì†ŒìŠ¤ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ + í”„ë¡œíŒŒì¼
â”œâ”€â”€ íƒ€ê²Ÿ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ (ìˆìœ¼ë©´)
â””â”€â”€ ê¸°ì¡´ ìœ ì‚¬ ë§¤í•‘ ê²€ìƒ‰
     â”‚
     â–¼
[Step 2] ë§¤í•‘ ë¡œì§ ìƒì„± (AI + Template)
â”œâ”€â”€ ì»¬ëŸ¼ ë§¤í•‘: ì†ŒìŠ¤ ì»¬ëŸ¼ â†’ ë³€í™˜ ê·œì¹™ â†’ íƒ€ê²Ÿ ì»¬ëŸ¼
â”œâ”€â”€ ì ì¬ SQL ìƒì„± (INSERT, MERGE, SCD ë“±)
â”œâ”€â”€ ê²€ì¦ SQL ìƒì„± (ê±´ìˆ˜, í•©ê³„, PK ì¤‘ë³µ ë“±)
â””â”€â”€ ë³€í™˜ ìœ í˜• ìë™ ë¶„ë¥˜ (1:1, ì§‘ê³„, ì¡°ì¸, íŒŒìƒ ë“±)
     â”‚
     â–¼
[Step 3] ì—‘ì…€ ë§¤í•‘ì •ì˜ì„œ ìë™ ê¸°ì…              â˜… í•µì‹¬
â”œâ”€â”€ ì •í•´ì§„ í…œí”Œë¦¿(í‘œì¤€ì–‘ì‹) ë¡œë“œ
â”œâ”€â”€ ì†ŒìŠ¤ í…Œì´ë¸” ì •ë³´ ì‹œíŠ¸ ìë™ ê¸°ì…
â”œâ”€â”€ íƒ€ê²Ÿ í…Œì´ë¸” ì •ë³´ ì‹œíŠ¸ ìë™ ê¸°ì…
â”œâ”€â”€ ì»¬ëŸ¼ë³„ ë§¤í•‘ ê·œì¹™ ì‹œíŠ¸ ìë™ ê¸°ì…
â”œâ”€â”€ ì ì¬ SQL ì‹œíŠ¸ ê¸°ì…
â”œâ”€â”€ ê²€ì¦ SQL ì‹œíŠ¸ ê¸°ì…
â””â”€â”€ .xlsx ë‹¤ìš´ë¡œë“œ ì œê³µ
     â”‚
     â–¼
[Step 4] ì‚¬ìš©ì ë¦¬ë·° & ìˆ˜ì •
â”œâ”€â”€ ì›¹ UIì—ì„œ ë§¤í•‘ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
â”œâ”€â”€ ì¸ë¼ì¸ ìˆ˜ì • ê°€ëŠ¥
â”œâ”€â”€ ìˆ˜ì • ì‚¬í•­ ë°˜ì˜ â†’ ì—‘ì…€ ì¬ìƒì„±
â””â”€â”€ í™•ì • â†’ ë²„ì „ ì €ì¥
```

#### 2.1.2 ë§¤í•‘ì •ì˜ì„œ ì—‘ì…€ í…œí”Œë¦¿ êµ¬ì¡°

```
[Sheet 1: ê°œìš”]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë§¤í•‘ID â”‚ ì‘ì„±ì¼ â”‚ ì‘ì„±ì â”‚ ì†ŒìŠ¤ì‹œìŠ¤í…œ â”‚ íƒ€ê²Ÿì‹œìŠ¤í…œ  â”‚
â”‚ ì ì¬ìœ í˜• â”‚ ì ì¬ì£¼ê¸° â”‚ ë³€í™˜ìœ í˜• â”‚ ë¹„ê³                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Sheet 2: ì†ŒìŠ¤ í…Œì´ë¸” ì •ë³´]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ No â”‚ ìŠ¤í‚¤ë§ˆ â”‚ í…Œì´ë¸”ëª… â”‚ ì»¬ëŸ¼ëª… â”‚ ë°ì´í„°íƒ€ì… â”‚ PK â”‚  â”‚
â”‚    â”‚        â”‚          â”‚        â”‚ ê¸¸ì´ â”‚ NULLì—¬ë¶€ â”‚ ì„¤ëª… â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Sheet 3: íƒ€ê²Ÿ í…Œì´ë¸” ì •ë³´]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ No â”‚ ìŠ¤í‚¤ë§ˆ â”‚ í…Œì´ë¸”ëª… â”‚ ì»¬ëŸ¼ëª… â”‚ ë°ì´í„°íƒ€ì… â”‚ PK â”‚  â”‚
â”‚    â”‚        â”‚          â”‚        â”‚ ê¸¸ì´ â”‚ NULLì—¬ë¶€ â”‚ ì„¤ëª… â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Sheet 4: ì»¬ëŸ¼ ë§¤í•‘]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ No â”‚ íƒ€ê²Ÿì»¬ëŸ¼ â”‚ ì†ŒìŠ¤ì»¬ëŸ¼ â”‚ ë³€í™˜ê·œì¹™ â”‚ ë³€í™˜ìœ í˜• â”‚ ë¹„ê³       â”‚
â”‚    â”‚          â”‚          â”‚ (ìƒì„¸)   â”‚ 1:1/ì§‘ê³„ â”‚           â”‚
â”‚    â”‚          â”‚          â”‚          â”‚ /íŒŒìƒ/ì½”ë“œ â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Sheet 5: ì ì¬ SQL]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ -- ì ì¬ SQL (ìë™ ìƒì„±)                               â”‚
â”‚ MERGE INTO DW_ê³ ê°_FACT tgt                          â”‚
â”‚ USING (SELECT ... FROM ODS_ê³ ê°) src                 â”‚
â”‚ ON (tgt.ê³ ê°ID = src.ê³ ê°ID)                          â”‚
â”‚ WHEN MATCHED THEN UPDATE SET ...                     â”‚
â”‚ WHEN NOT MATCHED THEN INSERT ...;                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Sheet 6: ê²€ì¦ SQL]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê²€ì¦í•­ëª© â”‚ ê²€ì¦SQL â”‚ ê¸°ëŒ€ê²°ê³¼ â”‚ í—ˆìš©ì˜¤ì°¨              â”‚
â”‚ ê±´ìˆ˜ê²€ì¦ â”‚ SELECT COUNT(*) ... â”‚ ì†ŒìŠ¤=íƒ€ê²Ÿ â”‚ 0       â”‚
â”‚ í•©ê³„ê²€ì¦ â”‚ SELECT SUM(ê¸ˆì•¡) ... â”‚ ì†ŒìŠ¤=íƒ€ê²Ÿ â”‚ 0.01   â”‚
â”‚ PKì¤‘ë³µ  â”‚ SELECT ê³ ê°ID, COUNT(*) ... â”‚ MAX=1 â”‚ 0    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.1.3 ê¸°ìˆ  êµ¬í˜„

```python
# backend/app/core/export/mapping_sheet_generator.py

class MappingSheetGenerator:
    """ë§¤í•‘ì •ì˜ì„œ ì—‘ì…€ ìë™ ìƒì„±ê¸°"""
    
    def __init__(self, template_path: str):
        self.template = openpyxl.load_workbook(template_path)
    
    async def generate(self, mapping_result: MappingResult) -> bytes:
        """
        AIê°€ ìƒì„±í•œ ë§¤í•‘ ê²°ê³¼ë¥¼ ì—‘ì…€ í…œí”Œë¦¿ì— ìë™ ê¸°ì…
        
        Args:
            mapping_result: Agentê°€ ìƒì„±í•œ ë§¤í•‘ ì •ë³´
                - source_meta: ì†ŒìŠ¤ í…Œì´ë¸”/ì»¬ëŸ¼ ì •ë³´
                - target_meta: íƒ€ê²Ÿ í…Œì´ë¸”/ì»¬ëŸ¼ ì •ë³´
                - column_mappings: ì»¬ëŸ¼ë³„ ë§¤í•‘ ê·œì¹™
                - load_sql: ì ì¬ SQL
                - validation_sqls: ê²€ì¦ SQL ëª©ë¡
        
        Returns:
            ì—‘ì…€ íŒŒì¼ ë°”ì´íŠ¸ (ë‹¤ìš´ë¡œë“œìš©)
        """
        wb = copy(self.template)
        
        # Sheet 1: ê°œìš” ì •ë³´ ê¸°ì…
        self._fill_overview(wb['ê°œìš”'], mapping_result)
        
        # Sheet 2: ì†ŒìŠ¤ í…Œì´ë¸” ì •ë³´
        self._fill_table_info(wb['ì†ŒìŠ¤ì •ë³´'], mapping_result.source_meta)
        
        # Sheet 3: íƒ€ê²Ÿ í…Œì´ë¸” ì •ë³´
        self._fill_table_info(wb['íƒ€ê²Ÿì •ë³´'], mapping_result.target_meta)
        
        # Sheet 4: ì»¬ëŸ¼ ë§¤í•‘
        self._fill_column_mapping(wb['ì»¬ëŸ¼ë§¤í•‘'], mapping_result.column_mappings)
        
        # Sheet 5: ì ì¬ SQL
        self._fill_sql(wb['ì ì¬SQL'], mapping_result.load_sql)
        
        # Sheet 6: ê²€ì¦ SQL
        self._fill_validation(wb['ê²€ì¦SQL'], mapping_result.validation_sqls)
        
        return self._to_bytes(wb)
    
    def _fill_column_mapping(self, ws, mappings: list[ColumnMapping]):
        """ì»¬ëŸ¼ ë§¤í•‘ ì‹œíŠ¸ ìë™ ê¸°ì…"""
        for i, m in enumerate(mappings, start=2):  # 1í–‰ì€ í—¤ë”
            ws.cell(row=i, column=1, value=i-1)           # No
            ws.cell(row=i, column=2, value=m.target_col)   # íƒ€ê²Ÿì»¬ëŸ¼
            ws.cell(row=i, column=3, value=m.source_col)   # ì†ŒìŠ¤ì»¬ëŸ¼
            ws.cell(row=i, column=4, value=m.transform_rule)  # ë³€í™˜ê·œì¹™
            ws.cell(row=i, column=5, value=m.transform_type)  # ë³€í™˜ìœ í˜•
            ws.cell(row=i, column=6, value=m.description)     # ë¹„ê³ 
```

---

### 2.2 Feature #2: Live Execution & Auto-Fix Engine

#### 2.2.1 ì „ì²´ íë¦„

```
[ê²€ì¦ SQL ìƒì„± ì™„ë£Œ]
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Live Execution Panel (UI)            â”‚
â”‚                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ -- ê±´ìˆ˜ ê²€ì¦ SQL                         â”‚ â”‚
â”‚  â”‚ SELECT                                   â”‚ â”‚
â”‚  â”‚   (SELECT COUNT(*) FROM src) as src_cnt, â”‚ â”‚
â”‚  â”‚   (SELECT COUNT(*) FROM tgt) as tgt_cnt  â”‚ â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â”‚          [â–¶ ì‹¤í–‰]  [ğŸ“‹ ë³µì‚¬]  [âœï¸ ìˆ˜ì •]   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                               â”‚
â”‚  ì‹¤í–‰ ê²°ê³¼:                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ src_cnt: 15,234                          â”‚ â”‚
â”‚  â”‚ tgt_cnt: 15,231                          â”‚ â”‚
â”‚  â”‚ ìƒíƒœ: âš ï¸ FAIL (ì°¨ì´: 3ê±´)                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                               â”‚
â”‚  AI ë¶„ì„:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ” ì›ì¸ ë¶„ì„:                             â”‚ â”‚
â”‚  â”‚ â†’ ì†ŒìŠ¤ì— NULL PK 3ê±´ ì¡´ì¬í•˜ì—¬ ì ì¬ ì‹œ      â”‚ â”‚
â”‚  â”‚   MERGE ON ì¡°ê±´ ë¶ˆì¼ì¹˜ë¡œ ëˆ„ë½ëœ ê²ƒìœ¼ë¡œ     â”‚ â”‚
â”‚  â”‚   ì¶”ì •ë©ë‹ˆë‹¤.                              â”‚ â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â”‚ ğŸ“Œ ê·¼ê±° SQL: (SELECTë§Œ ìë™ ì‹¤í–‰)          â”‚ â”‚
â”‚  â”‚   SELECT * FROM src WHERE pk_col IS NULL â”‚ â”‚
â”‚  â”‚   â†’ ê²°ê³¼: 3ê±´                             â”‚ â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â”‚ ğŸ”§ í•´ê²° ë°©ì•ˆ:                             â”‚ â”‚
â”‚  â”‚ [ë°©ì•ˆ1] ì†ŒìŠ¤ NULL PK ê±´ ì œì™¸í•˜ê³  ì¬ì ì¬    â”‚ â”‚
â”‚  â”‚ [ë°©ì•ˆ2] NULL PK â†’ ëŒ€ì²´í‚¤ ìƒì„± í›„ ì ì¬      â”‚ â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â”‚   [ğŸ”„ ë°©ì•ˆ1 ì ìš© ì‹¤í–‰]  [ğŸ”„ ë°©ì•ˆ2 ì ìš©]    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.2 Execution Engine ìƒì„¸ ì•„í‚¤í…ì²˜

```
Execution & Auto-Fix Engine
â”‚
â”œâ”€â”€ SQL Executor (ì‹¤í–‰ê¸°)
â”‚   â”œâ”€â”€ Safe Executor          # SELECTë§Œ í—ˆìš©í•˜ëŠ” ì•ˆì „ ì‹¤í–‰ê¸°
â”‚   â”‚   â”œâ”€â”€ Read-only ì»¤ë„¥ì…˜ ì‚¬ìš©
â”‚   â”‚   â”œâ”€â”€ íƒ€ì„ì•„ì›ƒ ì„¤ì • (ê¸°ë³¸ 30ì´ˆ)
â”‚   â”‚   â”œâ”€â”€ ê²°ê³¼ í–‰ìˆ˜ ì œí•œ (ê¸°ë³¸ 1000í–‰)
â”‚   â”‚   â””â”€â”€ ì‹¤í–‰ ì´ë ¥ ë¡œê¹…
â”‚   â”‚
â”‚   â”œâ”€â”€ DML Executor           # INSERT/UPDATE/DELETE ì‹¤í–‰ê¸°
â”‚   â”‚   â”œâ”€â”€ â˜… ë°˜ë“œì‹œ ì‚¬ìš©ì ìŠ¹ì¸ í•„ìš”
â”‚   â”‚   â”œâ”€â”€ DRY RUN ë¨¼ì € (EXPLAIN + ì˜í–¥ í–‰ìˆ˜ ì˜ˆì¸¡)
â”‚   â”‚   â”œâ”€â”€ íŠ¸ëœì­ì…˜ ë˜í•‘ (ë¡¤ë°± ê°€ëŠ¥)
â”‚   â”‚   â””â”€â”€ ì‹¤í–‰ ì „í›„ ìŠ¤ëƒ…ìƒ· ë¹„êµ
â”‚   â”‚
â”‚   â””â”€â”€ Batch Executor         # ë‹¤ê±´ ê²€ì¦ ì¼ê´„ ì‹¤í–‰
â”‚       â”œâ”€â”€ ê²€ì¦ SQL ì„¸íŠ¸ë¥¼ ìˆœì°¨/ë³‘ë ¬ ì‹¤í–‰
â”‚       â”œâ”€â”€ ê²°ê³¼ ì§‘ê³„ (Pass/Fail/Warn ì¹´ìš´íŠ¸)
â”‚       â””â”€â”€ ê²€ì¦ ë¦¬í¬íŠ¸ ìë™ ìƒì„±
â”‚
â”œâ”€â”€ Result Analyzer (ê²°ê³¼ ë¶„ì„ê¸°)
â”‚   â”œâ”€â”€ Expectation Matcher    # ê¸°ëŒ€ê°’ vs ì‹¤ì œê°’ ë¹„êµ
â”‚   â”œâ”€â”€ Anomaly Detector       # ì´ìƒì¹˜ ìë™ ê°ì§€
â”‚   â”œâ”€â”€ Diff Calculator        # ì†ŒìŠ¤-íƒ€ê²Ÿ ì°¨ì´ ìƒì„¸ ê³„ì‚°
â”‚   â””â”€â”€ Trend Comparator       # ì´ì „ ì‹¤í–‰ê³¼ ì¶”ì´ ë¹„êµ
â”‚
â”œâ”€â”€ AI Diagnostician (AI ì§„ë‹¨ê¸°)          â˜… í•µì‹¬
â”‚   â”œâ”€â”€ Error Classifier       # ì—ëŸ¬ ìœ í˜• ë¶„ë¥˜
â”‚   â”‚   â”œâ”€â”€ DATA_QUALITY       # ë°ì´í„° í’ˆì§ˆ ë¬¸ì œ
â”‚   â”‚   â”œâ”€â”€ SCHEMA_MISMATCH    # ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜
â”‚   â”‚   â”œâ”€â”€ LOGIC_ERROR        # ë³€í™˜ ë¡œì§ ì˜¤ë¥˜
â”‚   â”‚   â”œâ”€â”€ PERFORMANCE        # ì„±ëŠ¥ ë¬¸ì œ
â”‚   â”‚   â””â”€â”€ SYSTEM_ERROR       # ì‹œìŠ¤í…œ ì—ëŸ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ Root Cause Prober      # ì›ì¸ íƒìƒ‰ (ì¶”ê°€ SQL ìë™ ì‹¤í–‰)
â”‚   â”‚   â”œâ”€â”€ NULL ë¶„ì„ ì¿¼ë¦¬ ìë™ ìƒì„± + ì‹¤í–‰
â”‚   â”‚   â”œâ”€â”€ ì¤‘ë³µ ë¶„ì„ ì¿¼ë¦¬ ìë™ ìƒì„± + ì‹¤í–‰
â”‚   â”‚   â”œâ”€â”€ ë¶„í¬ ë¹„êµ ì¿¼ë¦¬ ìë™ ìƒì„± + ì‹¤í–‰
â”‚   â”‚   â””â”€â”€ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì´ë ¥ ì¡°íšŒ
â”‚   â”‚
â”‚   â””â”€â”€ Fix Generator          # ìˆ˜ì • SQL ìë™ ìƒì„±
â”‚       â”œâ”€â”€ ë°ì´í„° ì •ì œ SQL ìƒì„±
â”‚       â”œâ”€â”€ ë§¤í•‘ ë¡œì§ ìˆ˜ì • SQL ìƒì„±
â”‚       â”œâ”€â”€ ëŒ€ì•ˆ ì ì¬ SQL ìƒì„±
â”‚       â””â”€â”€ â˜… ì›í´ë¦­ ì‹¤í–‰ ì˜µì…˜ ì œê³µ
â”‚
â””â”€â”€ Report Generator (ë¦¬í¬íŠ¸ ìƒì„±ê¸°)
    â”œâ”€â”€ Validation Report (ê²€ì¦ ë¦¬í¬íŠ¸ Excel)
    â”œâ”€â”€ Execution Log (ì‹¤í–‰ ì´ë ¥)
    â””â”€â”€ Fix History (ìˆ˜ì • ì´ë ¥)
```

#### 2.2.3 Auto-Fix ì˜ì‚¬ê²°ì • íŠ¸ë¦¬

```python
# backend/app/core/execution/auto_fix.py

class AutoFixDecisionTree:
    """
    ê²€ì¦ ì‹¤íŒ¨ ì‹œ ìë™ ìˆ˜ì • ì˜ì‚¬ê²°ì • íŠ¸ë¦¬
    
    Level 1: ì¦‰ì‹œ ìë™ ìˆ˜ì • ê°€ëŠ¥ (ì‚¬ìš©ì í™•ì¸ í›„ ì›í´ë¦­)
    Level 2: AI ë¶„ì„ í›„ ìˆ˜ì •ì•ˆ ì œì‹œ (ì‚¬ìš©ì ì„ íƒ)
    Level 3: ë³µí•© ë¬¸ì œ â†’ ìƒì„¸ ë¶„ì„ ë¦¬í¬íŠ¸ ì œê³µ
    """
    
    DECISION_MAP = {
        # â”€â”€ Level 1: ìë™ ìˆ˜ì • ê°€ëŠ¥ â”€â”€
        "row_count_mismatch": {
            "probing_queries": [
                "ì†ŒìŠ¤ì—ë§Œ ì¡´ì¬í•˜ëŠ” í‚¤ ì¡°íšŒ",
                "íƒ€ê²Ÿì—ë§Œ ì¡´ì¬í•˜ëŠ” í‚¤ ì¡°íšŒ", 
                "NULL PK ê±´ìˆ˜ ì¡°íšŒ",
            ],
            "common_fixes": [
                {"condition": "null_pk > 0", 
                 "fix": "WHERE pk IS NOT NULL ì¡°ê±´ ì¶”ê°€"},
                {"condition": "src_only > 0 AND recent_insert", 
                 "fix": "ì¦ë¶„ ì¬ì ì¬ SQL ìƒì„±"},
                {"condition": "tgt_only > 0", 
                 "fix": "íƒ€ê²Ÿ orphan ë ˆì½”ë“œ ì •ë¦¬ SQL"},
            ]
        },
        
        "sum_mismatch": {
            "probing_queries": [
                "ê¸ˆì•¡ ì»¬ëŸ¼ NULL ê±´ìˆ˜",
                "ìŒìˆ˜ ê°’ ì¡´ì¬ ì—¬ë¶€",
                "ì†Œìˆ˜ì  ì ˆì‚¬ ì°¨ì´ í™•ì¸",
            ],
            "common_fixes": [
                {"condition": "null_amount > 0",
                 "fix": "COALESCE(ê¸ˆì•¡, 0) ì ìš©"},
                {"condition": "precision_diff",
                 "fix": "ROUND í•¨ìˆ˜ ì ìš© SQL"},
            ]
        },
        
        "type_mismatch": {
            "probing_queries": [
                "ë³€í™˜ ì‹¤íŒ¨ ê°’ ìƒ˜í”Œ ì¡°íšŒ",
                "ì†ŒìŠ¤ ë°ì´í„° íŒ¨í„´ ë¶„ì„",
            ],
            "common_fixes": [
                {"condition": "date_parse_fail",
                 "fix": "TO_DATE í¬ë§· ìˆ˜ì • SQL"},
                {"condition": "numeric_overflow",
                 "fix": "íƒ€ê²Ÿ ì»¬ëŸ¼ í¬ê¸° ALTER SQL"},
            ]
        },

        # â”€â”€ Level 2: AI ë¶„ì„ í•„ìš” â”€â”€
        "business_rule_violation": {
            "probing_queries": [
                "ìœ„ë°˜ ê±´ ìƒì„¸ ì¡°íšŒ",
                "íŒ¨í„´ë³„ ê·¸ë£¹í•‘",
                "ì´ì „ ë°°ì¹˜ì™€ ë¹„êµ",
            ],
            "approach": "AIê°€ ìœ„ë°˜ íŒ¨í„´ ë¶„ì„ í›„ ìˆ˜ì •ì•ˆ ë³µìˆ˜ ì œì‹œ"
        },
        
        # â”€â”€ Level 3: ë³µí•© ë¬¸ì œ â”€â”€
        "multiple_failures": {
            "approach": "ì „ì²´ ê²€ì¦ ê²°ê³¼ ì¢…í•© ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±",
            "output": "ì›ì¸ ìƒê´€ê´€ê³„ ë¶„ì„ + ìš°ì„ ìˆœìœ„ ìˆ˜ì • ë¡œë“œë§µ"
        }
    }
```

#### 2.2.4 ì‹¤í–‰ ì•ˆì „ì¥ì¹˜ (v2.1 ê°•í™”)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Safety Guard Rails (v2.1)                  â”‚
â”‚                                                           â”‚
â”‚  [Layer 0] Human-in-the-Loop (â˜… v2.1 í•µì‹¬ ì›ì¹™)          â”‚
â”‚  â”œâ”€â”€ AIëŠ” ìˆ˜ì • SQLì„ 'ì œì•ˆ'ë§Œ í•¨ (ìë™ ì‹¤í–‰ ê¸ˆì§€)          â”‚
â”‚  â”œâ”€â”€ UIì—ì„œ ì‚¬ëŒì´ SQL ë‚´ìš© í™•ì¸ í›„ [ì‹¤í–‰] ë²„íŠ¼ í´ë¦­       â”‚
â”‚  â”œâ”€â”€ Auto-Fix ë£¨í”„ ì—†ìŒ â€” ë§¤ ìˆ˜ì •ë§ˆë‹¤ ìŠ¹ì¸ í•„ìš”            â”‚
â”‚  â””â”€â”€ AI ì§„ë‹¨ ê·¼ê±° SQLì´ 3ê°œ ë¯¸ë§Œì´ë©´ ìˆ˜ì • ì œì•ˆ ë¶ˆê°€         â”‚
â”‚                                                           â”‚
â”‚  [Layer 1] SQL ë¶„ë¥˜                                       â”‚
â”‚  â”œâ”€â”€ SELECT â†’ ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥ (ê²€ì¦ ëª©ì )                   â”‚
â”‚  â”œâ”€â”€ DML (INSERT/UPDATE/DELETE) â†’ ë°˜ë“œì‹œ ì‚¬ìš©ì ìŠ¹ì¸       â”‚
â”‚  â””â”€â”€ DDL (CREATE/ALTER/DROP) â†’ ì´ì¤‘ ìŠ¹ì¸ + ë³„ë„ ê²½ê³        â”‚
â”‚                                                           â”‚
â”‚  [Layer 2] DB ê³„ì • ê¶Œí•œ ë¶„ë¦¬ (ìš´ì˜ ì •ì±…)                   â”‚
â”‚  â”œâ”€â”€ ê²€ì¦ ê³„ì •: SELECT ê¶Œí•œë§Œ (ë©”ì¸ ìŠ¤í‚¤ë§ˆ)                 â”‚
â”‚  â”œâ”€â”€ í…ŒìŠ¤íŠ¸ ê³„ì •: ì „ìš© ìƒŒë“œë°•ìŠ¤ ìŠ¤í‚¤ë§ˆ ì“°ê¸° ê¶Œí•œë§Œ           â”‚
â”‚  â””â”€â”€ ì•± ì½”ë“œ: sqlglotìœ¼ë¡œ SQL êµ¬ë¬¸ íŒŒì‹± â†’ SELECT ì—¬ë¶€ ê²€ì‚¬  â”‚
â”‚                                                           â”‚
â”‚  [Layer 3] ì‚¬ì „ ê²€ì¦                                       â”‚
â”‚  â”œâ”€â”€ EXPLAIN PLAN ìë™ ì‹¤í–‰ (ì˜ˆìƒ ë¹„ìš© í™•ì¸)                â”‚
â”‚  â”œâ”€â”€ ì˜í–¥ í–‰ìˆ˜ ì˜ˆì¸¡ (ì „ì²´ í–‰ì˜ 10% ì´ˆê³¼ ì‹œ ê²½ê³ )            â”‚
â”‚  â””â”€â”€ íƒ€ê²Ÿ í…Œì´ë¸” í–‰ìˆ˜ ëŒ€ë¹„ ë¹„ìœ¨ ì²´í¬                        â”‚
â”‚                                                           â”‚
â”‚  [Layer 4] ì‹¤í–‰ ì¤‘ ë³´í˜¸                                    â”‚
â”‚  â”œâ”€â”€ Statement Timeout (ê¸°ë³¸ 30ì´ˆ, ì„¤ì • ê°€ëŠ¥)               â”‚
â”‚  â”œâ”€â”€ íŠ¸ëœì­ì…˜ ë˜í•‘ (ì‹¤íŒ¨ ì‹œ ìë™ ë¡¤ë°±)                      â”‚
â”‚  â””â”€â”€ Row Limit (SELECT ê²°ê³¼ 1000í–‰ ì œí•œ)                   â”‚
â”‚                                                           â”‚
â”‚  [Layer 5] ì‹¤í–‰ í›„ ê°ì‚¬                                    â”‚
â”‚  â”œâ”€â”€ ëª¨ë“  ì‹¤í–‰ SQL + ê²°ê³¼ SQLite ë¡œê¹…                       â”‚
â”‚  â”œâ”€â”€ ë³€ê²½ ì „/í›„ ìŠ¤ëƒ…ìƒ· ì €ì¥ (DMLì˜ ê²½ìš°)                    â”‚
â”‚  â””â”€â”€ ë¡¤ë°± SQL ìë™ ìƒì„± (DMLì˜ ê²½ìš°)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.3 Feature #3: API ë¬¸ì„œ â†’ DW ì„¤ê³„ ìë™ ì¶”ì²œ ì—”ì§„

#### 2.3.1 ì „ì²´ íë¦„

```
[ì‚¬ìš©ì]
"ê³µê³µë°ì´í„° API ë¬¸ì„œ ì²¨ë¶€" (PDF/JSON/Swagger)
     â”‚
     â–¼
[Step 1] ì…ë ¥ ì²˜ë¦¬ (ìš°ì„ ìˆœìœ„ ìˆœ)              â˜… v2.1 ì…ë ¥ ì „ëµ
â”œâ”€â”€ 1ìˆœìœ„: Swagger/OpenAPI (JSON/YAML) â†’ ì™„ì „ ìë™ íŒŒì‹± (ê¶Œì¥)
â”œâ”€â”€ 2ìˆœìœ„: Excel/CSV í…Œì´ë¸” ì •ì˜ì„œ â†’ í˜„ì¬ parser ì¬ì‚¬ìš©
â”œâ”€â”€ 3ìˆœìœ„: PDF í…ìŠ¤íŠ¸ â†’ AIë¡œ ì´ˆì•ˆë§Œ ì¶”ì¶œ (ì‚¬ìš©ì ê²€í†  í•„ìˆ˜)
â”‚   â””â”€â”€ âš  í‘œ/ì´ë¯¸ì§€ í¬í•¨ PDFëŠ” íŒŒì‹± ì˜¤ë¥˜ ë°œìƒ ê°€ëŠ¥ â€” ìˆ˜ë™ ë³´ì • ì•ˆë‚´
â”œâ”€â”€ ì‘ë‹µ í•„ë“œ ëª©ë¡ ì¶”ì¶œ (í•„ë“œëª…, íƒ€ì…, ì„¤ëª…)
â””â”€â”€ ì—”ë“œí¬ì¸íŠ¸ë³„ ë°ì´í„° ê´€ê³„ ì¶”ë¡ 
     â”‚
     â–¼
[Step 2] ë°ì´í„° ëª¨ë¸ ë¶„ì„ (AI)
â”œâ”€â”€ ì—”í‹°í‹° ì‹ë³„ (ê³ ê°, ì£¼ë¬¸, ìƒí’ˆ ë“±)
â”œâ”€â”€ ê´€ê³„ ì¶”ë¡  (1:N, M:N ë“±)
â”œâ”€â”€ í‚¤ í›„ë³´ ì‹ë³„ (PK, FK, NK)
â”œâ”€â”€ ì½”ë“œì„±/ë§ˆìŠ¤í„°/íŠ¸ëœì­ì…˜ ë¶„ë¥˜
â””â”€â”€ ì‹œê°„ ì°¨ì› ì‹ë³„ (ì´ë ¥ ê´€ë¦¬ í•„ìš” ì—¬ë¶€)
     â”‚
     â–¼
[Step 3] 3-Layer ëª¨ë¸ ìë™ ì„¤ê³„
â”‚
â”œâ”€â”€ ODS Layer (Operational Data Store)
â”‚   â”œâ”€â”€ API ì‘ë‹µ êµ¬ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ë°˜ì˜í•œ Staging í…Œì´ë¸”
â”‚   â”œâ”€â”€ JSON í•„ë“œ â†’ ì»¬ëŸ¼ í”Œë«ë‹
â”‚   â”œâ”€â”€ ì ì¬ ì´ë ¥ ì»¬ëŸ¼ ì¶”ê°€ (etl_dt, batch_id)
â”‚   â””â”€â”€ DDL ìë™ ìƒì„±
â”‚
â”œâ”€â”€ DW Layer (Data Warehouse) â€” Star Schema
â”‚   â”œâ”€â”€ FACT í…Œì´ë¸” ì„¤ê³„
â”‚   â”‚   â”œâ”€â”€ ì¸¡ì •ê°’(Measure) ìë™ ì‹ë³„
â”‚   â”‚   â”œâ”€â”€ FK â†’ Dimension ì—°ê²°
â”‚   â”‚   â””â”€â”€ Grain ì •ì˜ (ì–´ë–¤ ë‹¨ìœ„ì˜ íŒ©íŠ¸ì¸ì§€)
â”‚   â”‚
â”‚   â”œâ”€â”€ DIMENSION í…Œì´ë¸” ì„¤ê³„
â”‚   â”‚   â”œâ”€â”€ ì½”ë“œì„± ë°ì´í„° â†’ Dimension ë¶„ë¦¬
â”‚   â”‚   â”œâ”€â”€ SCD Type ê²°ì • (Type1 / Type2)
â”‚   â”‚   â”œâ”€â”€ Surrogate Key ì„¤ê³„
â”‚   â”‚   â””â”€â”€ Date/Time Dimension ìë™ ì¶”ê°€
â”‚   â”‚
â”‚   â””â”€â”€ DDL + ë³€í™˜ SQL ìë™ ìƒì„±
â”‚
â”œâ”€â”€ DM Layer (Data Mart)
â”‚   â”œâ”€â”€ ì£¼ìš” ë¶„ì„ ê´€ì ë³„ Wide Table ì¶”ì²œ
â”‚   â”œâ”€â”€ ì‚¬ì „ ì§‘ê³„ í…Œì´ë¸” ì¶”ì²œ
â”‚   â””â”€â”€ VIEW / Materialized View ì œì•ˆ
â”‚
     â”‚
     â–¼
[Step 3.5] ì‚¬ìš©ì í¸ì§‘ (Draft â†’ í™•ì •)             â˜… v2.1 ì¶”ê°€
â”œâ”€â”€ AI ì´ˆì•ˆì„ st.data_editor í‘œ í˜•íƒœë¡œ í‘œì‹œ
â”‚   â”œâ”€â”€ ì—”í‹°í‹°(í…Œì´ë¸”)ëª…, ì»¬ëŸ¼ëª…, íƒ€ì… ì¸ë¼ì¸ ìˆ˜ì •
â”‚   â”œâ”€â”€ FACT/DIMENSION ë¶„ë¥˜ ë³€ê²½
â”‚   â”œâ”€â”€ SCD Type ì„ íƒ (Type1 / Type2)
â”‚   â””â”€â”€ ê´€ê³„(FK) ì¶”ê°€/ì‚­ì œ
â””â”€â”€ [í™•ì •] ë²„íŠ¼ í´ë¦­ â†’ ì•„ë˜ ìƒì„± ë‹¨ê³„ë¡œ ì§„í–‰
     â”‚
     â–¼
[Step 4] ì‹œê°í™” + ì›í´ë¦­ ìƒì„±
â”œâ”€â”€ ERD ì‹œê°í™” (Mermaid ë‹¤ì´ì–´ê·¸ë¨)            â˜… v2.1 ë³€ê²½ (React Flow ì œì™¸)
â”‚   â”œâ”€â”€ ODS â†’ DW â†’ DM íë¦„ë„ (Mermaid erDiagram)
â”‚   â”œâ”€â”€ í…Œì´ë¸” ê°„ ê´€ê³„ì„  (PK-FK)
â”‚   â””â”€â”€ st.markdownìœ¼ë¡œ Streamlit ë‚´ ë Œë”ë§
â”‚
â”œâ”€â”€ [DDL ìƒì„±] ë²„íŠ¼ â†’ ì „ì²´ CREATE TABLE ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ [ë³€í™˜SQL ìƒì„±] ë²„íŠ¼ â†’ ODSâ†’DW, DWâ†’DM ì ì¬ SQL
â””â”€â”€ [ë§¤í•‘ì •ì˜ì„œ] ë²„íŠ¼ â†’ ì—‘ì…€ ìë™ ìƒì„± (Feature #1 ì—°ë™)

â€» ì¸í„°ë™í‹°ë¸Œ React Flow ERDëŠ” Phase 4 ì´í›„ ë³„ë„ í”„ë¡ íŠ¸ì—”ë“œ ì „í™˜ ì‹œ êµ¬í˜„
```

#### 2.3.2 AI ë¶„ì„ í”„ë¡¬í”„íŠ¸ ì „ëµ

```python
API_TO_DW_SYSTEM_PROMPT = """
You are a Data Warehouse architect. Given an API specification,
design a complete 3-layer data model (ODS â†’ DW â†’ DM).

## Analysis Steps

1. **Entity Recognition**: Identify all business entities from the API.
2. **Relationship Mapping**: Determine 1:1, 1:N, M:N relationships.
3. **Fact vs Dimension**: Classify entities as:
   - FACT: Contains measurable events/transactions
   - DIMENSION: Contains descriptive attributes
   - BRIDGE: For M:N relationships
4. **Grain Definition**: Define the lowest level of detail for each fact.
5. **SCD Strategy**: Decide Type 1 vs Type 2 for each dimension.

## Output Format (JSON)
{
  "entities": [...],
  "ods_tables": [
    {"name": "ods_xxx", "columns": [...], "source_endpoint": "...", "ddl": "..."}
  ],
  "dw_tables": {
    "facts": [
      {"name": "fact_xxx", "grain": "...", "measures": [...], 
       "dimensions": [...], "ddl": "...", "etl_sql": "..."}
    ],
    "dimensions": [
      {"name": "dim_xxx", "scd_type": 2, "natural_key": "...",
       "surrogate_key": "...", "ddl": "...", "etl_sql": "..."}
    ]
  },
  "dm_tables": [
    {"name": "dm_xxx", "purpose": "...", "ddl": "...", "view_sql": "..."}
  ],
  "relationships": [
    {"from": "fact_xxx", "to": "dim_xxx", "type": "N:1", "join_key": "..."}
  ]
}
"""
```

#### 2.3.3 ì‹œê°í™” ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DW Design Viewer (UI)                    â”‚
â”‚                                                           â”‚
â”‚  [íƒ­: ODS]  [íƒ­: DW Star Schema]  [íƒ­: DM]  [íƒ­: ì „ì²´íë¦„] â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚    â”‚ DIM_ë‚ ì§œ  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚            â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â”‚  FACT_ê±°ë˜    â”‚            â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚              â”‚            â”‚ â”‚
â”‚  â”‚    â”‚ DIM_ê³ ê°  â”‚â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”€â”€â”€â”€â”€â”€â”€â”€â”‚ FACT_ì´ìš©ì‹¤ì  â”‚            â”‚ â”‚
â”‚  â”‚    â”‚ DIM_ìƒí’ˆ  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚ â”‚
â”‚  â”‚                      (Mermaid erDiagram / Phase 4+)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â”‚  ì„ íƒëœ í…Œì´ë¸”: FACT_ê±°ë˜                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì»¬ëŸ¼ëª…      â”‚ íƒ€ì…        â”‚ ì„¤ëª…       â”‚ FK        â”‚ â”‚
â”‚  â”‚ sk_ê±°ë˜     â”‚ BIGINT      â”‚ ëŒ€ë¦¬í‚¤     â”‚           â”‚ â”‚
â”‚  â”‚ fk_ë‚ ì§œ     â”‚ INT         â”‚ ë‚ ì§œ FK    â”‚ DIM_ë‚ ì§œ  â”‚ â”‚
â”‚  â”‚ fk_ê³ ê°     â”‚ INT         â”‚ ê³ ê° FK    â”‚ DIM_ê³ ê°  â”‚ â”‚
â”‚  â”‚ ê±°ë˜ê¸ˆì•¡    â”‚ DECIMAL     â”‚ ì¸¡ì •ê°’     â”‚           â”‚ â”‚
â”‚  â”‚ ê±°ë˜ê±´ìˆ˜    â”‚ INT         â”‚ ì¸¡ì •ê°’     â”‚           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                         â”‚
â”‚  [ DDL ë‹¤ìš´ë¡œë“œ] [ ë³€í™˜SQL] [ ë§¤í•‘ì •ì˜ì„œ] [ ê²€ì¦ë¦¬í¬íŠ¸] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ê°œì • ì•„í‚¤í…ì²˜ â€” ì „ì²´ í†µí•©ë„

### 3.1 Engine ê°„ ì—°ë™ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AETL v2 Integrated Flow                    â”‚
â”‚                                                                â”‚
â”‚                        User Interface                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ AI Chat  â”‚ SQL      â”‚ Mapping  â”‚ DW       â”‚ Monitoring â”‚ â”‚
â”‚   â”‚ Console  â”‚ Studio   â”‚ Manager  â”‚ Designer â”‚ Dashboard  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚          â”‚          â”‚          â”‚           â”‚         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â”‚                                     â”‚
â”‚                   Agent Core Engine                            â”‚
â”‚                          â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚                      â”‚                          â”‚         â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚   â”‚  â”‚Metadata â”‚  â”‚   SQL +   â”‚  â”‚Validation â”‚    â”‚         â”‚
â”‚   â”‚  â”‚ Engine  â”‚â—„â”€â”‚Transform  â”‚â”€â–ºâ”‚  Engine   â”‚    â”‚         â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚  Engine   â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚   â”‚       â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚          â”‚         â”‚
â”‚   â”‚       â”‚             â”‚              â”‚          â”‚         â”‚
â”‚   â”‚       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”       â”‚          â”‚         â”‚
â”‚   â”‚       â”‚      â”‚ â˜… Execution â”‚â—„â”€â”€â”€â”€â”€â”€â”˜          â”‚         â”‚
â”‚   â”‚       â”‚      â”‚   Engine    â”‚                   â”‚         â”‚
â”‚   â”‚       â”‚      â”‚(ì‹¤í–‰+ì§„ë‹¨+ì œì•ˆ)â”‚                   â”‚         â”‚
â”‚   â”‚       â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚         â”‚
â”‚   â”‚       â”‚             â”‚                          â”‚         â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚   â”‚  â”‚Lineage â”‚  â”‚ â˜… Export  â”‚  â”‚ Monitor   â”‚    â”‚         â”‚
â”‚   â”‚  â”‚ Engine  â”‚  â”‚  Engine   â”‚  â”‚  Engine   â”‚    â”‚         â”‚
â”‚   â”‚  â”‚(ë¦¬ë‹ˆì§€) â”‚  â”‚(ë§¤í•‘ì •ì˜ì„œ â”‚  â”‚(ëª¨ë‹ˆí„°ë§) â”‚    â”‚         â”‚
â”‚   â”‚  â”‚        â”‚  â”‚ DWì„¤ê³„ì„œ)  â”‚  â”‚          â”‚    â”‚         â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚   â”‚                                               â”‚         â”‚
â”‚   â”‚          â˜… = v2ì—ì„œ ìƒˆë¡œ ì¶”ê°€ëœ ì—”ì§„            â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â”‚                                     â”‚
â”‚                   Connection Pool                              â”‚
â”‚             Oracle â”‚ PG â”‚ MySQL â”‚ MSSQL â”‚ BigQuery             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 v2 ì¶”ê°€ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
aetl/backend/app/core/
â”‚
â”œâ”€â”€ execution/          â˜… ì‹ ê·œ â€” Live Execution Engine
â”‚   â”œâ”€â”€ executor.py         # SQL ì‹¤í–‰ê¸° (Safe/DML/Batch)
â”‚   â”œâ”€â”€ analyzer.py         # ê²°ê³¼ ë¶„ì„ê¸°
â”‚   â”œâ”€â”€ diagnostician.py    # AI ì§„ë‹¨ê¸°
â”‚   â”œâ”€â”€ auto_fix.py         # ìë™ ìˆ˜ì • ì—”ì§„
â”‚   â””â”€â”€ safety.py           # ì•ˆì „ì¥ì¹˜ (Guard Rails)
â”‚
â”œâ”€â”€ export/             â˜… ì‹ ê·œ â€” ì‚°ì¶œë¬¼ ìë™ ìƒì„± Engine
â”‚   â”œâ”€â”€ mapping_sheet.py    # ë§¤í•‘ì •ì˜ì„œ ì—‘ì…€ ìƒì„±
â”‚   â”œâ”€â”€ validation_report.py # ê²€ì¦ ë¦¬í¬íŠ¸ ìƒì„±
â”‚   â”œâ”€â”€ ddl_generator.py    # DDL ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
â”‚   â””â”€â”€ templates/          # ì—‘ì…€ í…œí”Œë¦¿ íŒŒì¼ë“¤
â”‚       â”œâ”€â”€ mapping_template.xlsx
â”‚       â””â”€â”€ validation_template.xlsx
â”‚
â”œâ”€â”€ designer/           â˜… ì‹ ê·œ â€” DW ì„¤ê³„ ìë™ ì¶”ì²œ Engine
â”‚   â”œâ”€â”€ api_parser.py       # API ë¬¸ì„œ íŒŒì‹± (Swagger/PDF)
â”‚   â”œâ”€â”€ entity_analyzer.py  # ì—”í‹°í‹°/ê´€ê³„ ë¶„ì„
â”‚   â”œâ”€â”€ star_schema.py      # Star Schema ì„¤ê³„ ìƒì„±
â”‚   â”œâ”€â”€ ddl_builder.py      # DDL ë¹Œë”
â”‚   â””â”€â”€ visualizer.py       # ERD ë°ì´í„° ìƒì„± (Mermaid ë‹¤ì´ì–´ê·¸ë¨)
â”‚
â”œâ”€â”€ lineage/            ê¸°ì¡´ ì—”ì§„ â€” â˜… v2.1 êµ¬í˜„ ë°©ì‹ í™•ì •
â”‚   â”œâ”€â”€ parser.py           # sqlglot ê¸°ë°˜ SQL â†’ AST íŒŒì‹± (ê·œì¹™ ì—”ì§„)
â”‚   â”œâ”€â”€ graph.py            # NetworkX DAG êµ¬ì„± (ì»¬ëŸ¼ ë¦¬ë‹ˆì§€ ê·¸ë˜í”„)
â”‚   â”œâ”€â”€ impact.py           # Forward/Backward ì˜í–¥ë„ íƒìƒ‰
â”‚   â”œâ”€â”€ explainer.py        # LLM: ê·¸ë˜í”„ ê²°ê³¼ë¥¼ í•œêµ­ì–´ë¡œ ì„¤ëª…
â”‚   â””â”€â”€ visualizer.py       # Mermaid flowchart ìƒì„± (Streamlit ë Œë”ë§)
â”‚
â””â”€â”€ (ê¸°íƒ€ ê¸°ì¡´ ì—”ì§„ë“¤...)
    â”œâ”€â”€ agent/
    â”œâ”€â”€ metadata/
    â”œâ”€â”€ transform/
    â”œâ”€â”€ validation/
    â””â”€â”€ monitor/
```

---

## 4. ê°œì • ë¡œë“œë§µ

### Phase 1: Foundation (4ì£¼) â€” ë³€ê²½ ì—†ìŒ
- DB Connector, Metadata Engine, ê¸°ë³¸ API

### Phase 2: Intelligence + Execution (5ì£¼) â€” â˜… í™•ì¥
- AI Agent í”„ë ˆì„ì›Œí¬
- SQL/Transform Engine
- **â˜… Execution Engine (Live ì‹¤í–‰ + ê²°ê³¼ ë¶„ì„)**
- Validation Engine + **â˜… Auto-Fix**

### Phase 3: Deliverables + Design (4ì£¼) â€” â˜… ì‹ ê·œ
- **â˜… ë§¤í•‘ì •ì˜ì„œ ìë™í™” (Excel Export)**
- **â˜… DW ì„¤ê³„ ì¶”ì²œ ì—”ì§„** (Swagger/Excel ì…ë ¥ â†’ AI ì´ˆì•ˆ â†’ st.data_editor í¸ì§‘)
- **â˜… DDL ì›í´ë¦­ ìƒì„± + ê²€ì¦ ë¦¬í¬íŠ¸ Excel**
- **â˜… Lineage Engine** (sqlglot íŒŒì‹± + NetworkX + Mermaid ì‹œê°í™”)

### Phase 4: UX + Production (3ì£¼)
- Monitoring Dashboard (Job ìƒíƒœ + AI Troubleshooter)
- ERD ì¸í„°ë™í‹°ë¸Œ ì‹œê°í™” (ë³„ë„ í”„ë¡ íŠ¸ì—”ë“œ ì „í™˜ ì‹œ React Flow ì ìš©)
- ë³´ì•ˆ + ì„±ëŠ¥ ìµœì í™” (DB ê³„ì • ê¶Œí•œ ë¶„ë¦¬, ì‹¤í–‰ ê°ì‚¬ ë¡œê·¸)

---

## 5. Agent Tool ì¶”ê°€ ì •ì˜ (v2)

```python
# v2ì—ì„œ ì¶”ê°€ëœ Agent ë„êµ¬ë“¤

AGENT_TOOLS_V2 = {
    # â”€â”€ Execution ë„êµ¬ â”€â”€
    "execute_query": {
        "desc": "SELECT SQLì„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ ë°˜í™˜",
        "params": {"sql": "str", "source_id": "int", "limit": "int"},
        "safety": "SELECT only, timeout 30s"
    },
    "execute_dml_with_approval": {
        "desc": "DML ì‹¤í–‰ (ì‚¬ìš©ì ìŠ¹ì¸ í›„)",
        "params": {"sql": "str", "source_id": "int", "dry_run": "bool"},
        "safety": "requires explicit user approval"
    },
    "run_validation_suite": {
        "desc": "ê²€ì¦ SQL ì„¸íŠ¸ë¥¼ ì¼ê´„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ ì§‘ê³„",
        "params": {"rule_ids": "list[int]", "auto_diagnose": "bool"}
    },
    "diagnose_failure": {
        "desc": "ê²€ì¦ ì‹¤íŒ¨ ì‹œ ì›ì¸ íƒìƒ‰ (ì¶”ê°€ SQL ìë™ ì‹¤í–‰)",
        "params": {"failure_result": "dict", "depth": "int"}
    },
    "generate_fix_sql": {
        "desc": "ì§„ë‹¨ ê²°ê³¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ì • SQL ìƒì„±",
        "params": {"diagnosis": "dict", "fix_strategy": "str"}
    },

    # â”€â”€ Export ë„êµ¬ â”€â”€
    "generate_mapping_sheet": {
        "desc": "ë§¤í•‘ ê²°ê³¼ë¥¼ ì—‘ì…€ ë§¤í•‘ì •ì˜ì„œë¡œ ìƒì„±",
        "params": {"mapping_id": "str", "template": "str"}
    },
    "generate_ddl_script": {
        "desc": "í…Œì´ë¸” ì„¤ê³„ë¡œë¶€í„° DDL ìŠ¤í¬ë¦½íŠ¸ ìƒì„±",
        "params": {"tables": "list[dict]", "db_type": "str"}
    },
    "generate_validation_report": {
        "desc": "ê²€ì¦ ì‹¤í–‰ ê²°ê³¼ë¥¼ Excel ë¦¬í¬íŠ¸ë¡œ ìƒì„±",
        "params": {"run_id": "str", "include_sql": "bool"}
    },

    # â”€â”€ Designer ë„êµ¬ â”€â”€
    "parse_api_document": {
        "desc": "API ë¬¸ì„œ(Swagger/PDF)ë¥¼ íŒŒì‹±í•˜ì—¬ êµ¬ì¡° ì¶”ì¶œ",
        "params": {"file_path": "str", "doc_type": "str"}
    },
    "design_star_schema": {
        "desc": "API êµ¬ì¡°ë¡œë¶€í„° ODS/DW/DM Star Schema ì„¤ê³„",
        "params": {"api_structure": "dict", "options": "dict"}
    },
    "generate_erd_diagram": {
        "desc": "ì„¤ê³„ ê²°ê³¼ë¥¼ Mermaid erDiagram ì½”ë“œë¡œ ë³€í™˜ (Streamlit ë Œë”ë§)",
        "params": {"design": "dict", "layer": "str"}
    }
}
```

---

## 6. í•µì‹¬ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ (End-to-End)

### ì‹œë‚˜ë¦¬ì˜¤: "ê³µê³µë°ì´í„° APIë¡œ DW êµ¬ì¶•"

```
[1] ì‚¬ìš©ì: ê³µê³µë°ì´í„° API ë¬¸ì„œ(Swagger) ì²¨ë¶€
    â†’ AETL: API íŒŒì‹± â†’ ì—”í‹°í‹° ë¶„ì„ â†’ ODS/DW/DM ì„¤ê³„ ìë™ ìƒì„±
    â†’ í™”ë©´ì— Star Schema ERD ì‹œê°í™”
    
[2] ì‚¬ìš©ì: "ì„¤ê³„ ì¢‹ì•„. DDL ìƒì„±í•´ì¤˜"
    â†’ AETL: [DDL ìƒì„±] ë²„íŠ¼ â†’ CREATE TABLE ìŠ¤í¬ë¦½íŠ¸ ë‹¤ìš´ë¡œë“œ
    â†’ ë˜ëŠ” [ë°”ë¡œ ì‹¤í–‰] â†’ ì‹¤ì œ DBì— í…Œì´ë¸” ìƒì„± (ìŠ¹ì¸ í›„)
    
[3] ì‚¬ìš©ì: "ODS â†’ DW ì ì¬ SQL ë§Œë“¤ì–´ì¤˜"  
    â†’ AETL: ë³€í™˜ SQL + ê²€ì¦ SQL ìë™ ìƒì„±
    â†’ í™”ë©´ì—ì„œ SQL ë¦¬ë·° ê°€ëŠ¥
    
[4] ì‚¬ìš©ì: "ë§¤í•‘ì •ì˜ì„œë¡œ ë‚´ë ¤ì¤˜"
    â†’ AETL: [ë§¤í•‘ì •ì˜ì„œ ë‹¤ìš´ë¡œë“œ] â†’ Excel ìë™ ê¸°ì… ì™„ë£Œ
    
[5] ì‚¬ìš©ì: "ê²€ì¦ ì‹¤í–‰í•´ë´"
    â†’ AETL: [â–¶ ì „ì²´ ì‹¤í–‰] â†’ ê±´ìˆ˜/í•©ê³„/PK ê²€ì¦ ì¼ê´„ ìˆ˜í–‰
    â†’ ê²°ê³¼: ê±´ìˆ˜ 3ê±´ ë¶ˆì¼ì¹˜ ë°œê²¬
    â†’ AI ìë™ ë¶„ì„: "ì†ŒìŠ¤ NULL PK 3ê±´" ì§„ë‹¨
    â†’ [ìˆ˜ì • ì ìš©] ë²„íŠ¼ â†’ WHERE pk IS NOT NULL ì¶”ê°€ â†’ ì¬ì ì¬ â†’ ì¬ê²€ì¦ PASS
    
[6] ì™„ë£Œ: ê²€ì¦ ë¦¬í¬íŠ¸ Excel ë‹¤ìš´ë¡œë“œ
```

---

*v2 ê°œì •: ìƒì„±(Generate)ì„ ë„˜ì–´ ì‹¤í–‰(Execute)í•˜ê³  ì‚°ì¶œë¬¼(Deliver)ê¹Œì§€ â€” ì‚¬ëŒì˜ ì¼ì„ ì¤„ì´ëŠ” í”Œë«í¼*
